## replicate databases
*/20 * * * * curl -X POST http://shibachan:MuchWOWSuchAmAzE@127.0.0.1:15984/_replicate  -d '{"target":"junlin", "source":"http://shibachan:MuchWOWSuchAmAzE@172.17.0.1:5984/junlin", "continuous": true}' -H "Content-Type: application/json"

*/20 * * * * curl -X POST http://shibachan:MuchWOWSuchAmAzE@127.0.0.1:15984/_replicate  -d '{"target":"history", "source":"http://shibachan:MuchWOWSuchAmAzE@172.17.0.1:5984/history", "continuous": true}' -H "Content-Type: application/json"

*/20 * * * * curl -X POST http://shibachan:MuchWOWSuchAmAzE@127.0.0.1:15984/_replicate  -d '{"target":"finished_user", "source":"http://shibachan:MuchWOWSuchAmAzE@172.17.0.1:5984/finished_user", "continuous": true}' -H "Content-Type: application/json"

## restart history crawler to crawler new users
*/30 * * * * if [[ $(sudo docker inspect -f '{{.State.Running}}' history) != "true" ]]; then sudo docker restart history; fi 

## restart history crawler if memory consumption is too high
0 * * * * if [[ $(sudo docker exec history ps -o %mem,cmd | grep python | awk '{print $1}') > 50 ]]; then sudo docker restart history; fi